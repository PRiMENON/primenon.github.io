{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/20230109112500/","result":{"data":{"site":{"siteMetadata":{"title":"PRiMENON.log"}},"markdownRemark":{"id":"1ba7afa4-11c5-5534-91bb-2ad7e29da786","excerpt":"記憶が薄れる前に記録します。 スマホのケースを探していた、ただそれだけなんだ 時は2021年12月にさかのぼります。Google 検索でスマートフォンのケースを探していて検索結果を進んでいくと、ヒットしているウェブサイトの URL…","html":"<p>記憶が薄れる前に記録します。</p>\n<h2>スマホのケースを探していた、ただそれだけなんだ</h2>\n<p>時は2021年12月にさかのぼります。Google 検索でスマートフォンのケースを探していて検索結果を進んでいくと、ヒットしているウェブサイトの URL に違和感を感じました。</p>\n<p>画像は正常なウェブサイトの例です。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.139240506329116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABaUlEQVQoz31S227jIBTM//9eX5I2atbZxsbmcLG5Y8OsIG2l9mGRRqNz4WjmwCmkdJZCQuu1EHFIqeCsQ84JwXuE4DvHmFBK6fjfOTlSr0JYrGsonFtYmyCFw33QmJkFmzbEuKPWiuM4OjeUoyClhJxzz3/VTuvLy/h3HEGcalNHnDAxhsdjglK6K1ZaY1kWCCGglMK6rhBCYhwnSNncaYQQngrN+XpdyIHIFGMC3q8cb68z5lliZhrsE0pacLK43QhKOUyThjERKR0/LRcfztvWrLpircO2GVgbkFNuOXgfkFJG+OTjqP1irXhaL/XnQNRy4Uxi+CPKODYmCDId90FgeqxQ0oMvG6R0UDL03TYWwiPvTWH93u2pMHZ5vL1jZLzwhcC5AmMzhvsHbrcPLIsEYxxEClpvmGcCYwLD/QHGCMZYeO87ngOVujghkPe9pBS/i+0F9z0jxNDjGGN/ydbT8i1uPb+/zT9XfGYsPW0rAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"20230109 01\"\n        title=\"20230109 01\"\n        src=\"/static/782776d870dd598371ff6fd154bce792/f058b/20230109_01.png\"\n        srcset=\"/static/782776d870dd598371ff6fd154bce792/c26ae/20230109_01.png 158w,\n/static/782776d870dd598371ff6fd154bce792/6bdcf/20230109_01.png 315w,\n/static/782776d870dd598371ff6fd154bce792/f058b/20230109_01.png 630w,\n/static/782776d870dd598371ff6fd154bce792/0786c/20230109_01.png 663w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>赤く囲った部分は、ウェブサイトに含まれる文字列を抽出して表示しています。<code class=\"language-text\">amazon.co.jp</code> なので日本語が含まれているのは当然ですね。</p>\n<p>海外ドメインであれば、大体は日本語で表示されることは少ないのです。<code class=\"language-text\">jp.domain.com</code> や <code class=\"language-text\">www.domain.com/jp/</code>のように日本語向けのページが用意されているようなら別です。検索結果に表示されているウェブサイトは、トップレベルドメインは <code class=\"language-text\">.jp</code> ではないのに日本語が書いてあったんです。</p>\n<p>違和感を感じるウェブサイトを、ブラウザのシークレットモードで何個か開くと Not Found や Forbidden でしたが、中には別の URL にリダイレクトしたり、私が利用しているセキュリティ対策ソフト ESET が警告を表示することがありました。</p>\n<p>「もしかして、日本の企業が所有するドメインもこういった事例があるのではないか」と、いくつか思い当たるトップレベルドメインを Google で検索してみるとヒットしました。自分が遭遇したのは、個人のブログをはじめ、病院、高等学校、私立大学、企業、不動産、飲食店、ホテル、東京都が管理する公園事務所など多種多様でした。</p>\n<ul>\n<li><code class=\"language-text\">co.jp</code> - 企業</li>\n<li><code class=\"language-text\">or.jp</code> - 財団法人や社団法人など企業以外の法人</li>\n<li><code class=\"language-text\">ac.jp</code> - 18歳以上を対象にした教育機関</li>\n<li><code class=\"language-text\">ed.jp</code> - 18歳未満を対象にした教育機関</li>\n<li><code class=\"language-text\">go.jp</code> - 日本の政府機関や各省庁所管の研究所、特殊法人、独立行政法人</li>\n<li><code class=\"language-text\">ne.jp</code> - ネットワークサービス提供者</li>\n<li><code class=\"language-text\">gr.jp</code> - 任意団体</li>\n</ul>\n<p>地方自治体が所有しているドメインもあります。</p>\n<ul>\n<li><code class=\"language-text\">地域名.jp</code> - 誰でも登録可能だったので自治体用ではない。<a href=\"https://jprs.jp/whatsnew/notice/2011/20110926-geo.html\">2012年3月31日で新規登録終了</a>\n<ul>\n<li><code class=\"language-text\">tokyo.jp</code> や <code class=\"language-text\">kanagawa.jp</code> など。</li>\n</ul>\n</li>\n<li><code class=\"language-text\">lg.jp</code> - 都道府県、市区町村、ただし全国で使用されているわけではなく、<code class=\"language-text\">地域名.jp</code>を使い続ける自治体もある。</li>\n</ul>\n<p>地方自治体ではさすがにないだろうなと探してみると、山梨県立図書館が管理しているウェブサイト「発見！やまなしナビ」がヒットしました。\r\n画像のように、URLは「発見！やまなしナビ」なのに、英語のページが大量に作成されています。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 109.49367088607596%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAIAAABPIytRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACjklEQVQ4y4WUy25URxCG50WIPRgieZeEBSAHiafkBSKxYRmTDTPDjI3yCEEE7LFnzrW7T1/O6Wv1LTrDAgXh41KpVJtPf//V1T07+/3l2dnLZ89f/Prk6fzh46Ofjo8ezI+OT77l/Ft/PH90ND95ePLzk99+OT09nW0uLteby+VytVksFn+evzt/uzh/uzr/a73erNeb5Wq9XK3fH/pDvVgtV4vl+1d/fHj95t0s55xS9D4kB1nKZHSQQ1Iq3x0x5b8/pj0OM++9tcCEFb3UyjhlrdLgwI3p/CFCCPH/kXPWWs9iTNZBUeKyIoiIQYJUzhjnffAhKK0B4HvplFPO2phZTNlS2n76t/38mW2vo9EAwRoL4LwHpZT3/oeHNyOck+Z9+aVorqvqy55igbHsiGJMC2FiTHc5P8AxwiBZ3QhEeIssF8Y4Z8Fa5xz4EKbglJLpWHtVoNuK3FRdgREaUDso5b7OaRKO0VHKykpUDS8r3rSMD30/AHgACNPKMQRLOd41+LbGNxXeE4wlRpJS5RzEGO7x7ERP90VXlLyqrRiMGQ1772G0PO05BkNou2vxtqz/2XYlwUTSbkzOVUr3TDt40fdN03edUwooc4OEEGMIIfh74BS8IbS+Kpqbqr2t6a5pSorQwJnqyKCVnVR2FkQv6tYg7BkHMYA2AONGf62TsFGG8rLA1W1T71qya5vrhhApxLhhE8f23o8Dc4yzqtGYOMoc6Zy2o+Z4z1OeY4yzGLxBpL3ao22BrguyrdqSESL73vTCWOcn4RjBe0apYJx3jPH+sGHSOtDaOgdTcIrRWqgbhpAgXc+5JkjRTvfCGgNT/8lBeZxq13EptdZWKiOVVmM1Spm7HnPOOYTwH38xv3S7qfs4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"FG OWdqacAU2ZeM\"\n        title=\"FG OWdqacAU2ZeM\"\n        src=\"/static/89d6100901267a3fff738c9ef61961fc/f058b/FG-OWdqacAU2ZeM.png\"\n        srcset=\"/static/89d6100901267a3fff738c9ef61961fc/c26ae/FG-OWdqacAU2ZeM.png 158w,\n/static/89d6100901267a3fff738c9ef61961fc/6bdcf/FG-OWdqacAU2ZeM.png 315w,\n/static/89d6100901267a3fff738c9ef61961fc/f058b/FG-OWdqacAU2ZeM.png 630w,\n/static/89d6100901267a3fff738c9ef61961fc/40601/FG-OWdqacAU2ZeM.png 945w,\n/static/89d6100901267a3fff738c9ef61961fc/78612/FG-OWdqacAU2ZeM.png 1260w,\n/static/89d6100901267a3fff738c9ef61961fc/21b4d/FG-OWdqacAU2ZeM.png 1280w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>実際にクリックしたときの挙動です。まったく別の URL にリダイレクトします。この例では、ファッションサイトですが、中にはアダルトグッズだったりスマートフォンのケースだったり電気工具の部品だったりでした。</p>\n<p>ファッションサイトは実際に存在するサイトをコピーしてきたものかと思います。目的は、クレジットカード情報を搾取する、いわゆるフィッシングサイトと思われます。この動作はまだ優しい？方です。</p>\n<p>さらには、リダイレクト先に悪意のあるスクリプトが埋め込んであり、閲覧した瞬間にスクリプトが実行されたり、攻撃対象サイト側に悪意のあるスクリプトを仕掛けられる場合もあります。</p>\n<img src=\"/89a2fbd7a42648c6fffcc33988495907/navi-lib-pref-yamanashi-jp.webp\" class=\"remark-copy-image\">\n<h2>どうやって伝えるのが（自分が）安全なのか</h2>\n<p>私は、インターネットセキュリティや脆弱性の知識豊富の人間ではありません。インターネットがちょっと詳しいだけです。</p>\n<p>ウェブサイトが改ざんされている＝お問い合わせフォームも汚染されていると考えて、Twitter アカウントからお知らせ（メンション）したツイートが以下です。</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"ja\" dir=\"ltr\">. <a href=\"https://twitter.com/lib_pref_ymns?ref_src=twsrc%5Etfw\">@lib_pref_ymns</a> こんばんは。Google検索していたら、御社サイトに様々な英語のページが作成され、Googleにインデックスされています（画像はGoogleで「site:<a href=\"https://t.co/oGvYfZoTIY\">https://t.co/oGvYfZoTIY</a>」を検索）。御社サイトは攻撃者に改ざんされており、自由にファイルを作成できる状態にあるようです。（続く） <a href=\"https://t.co/CXMhzSEMWu\">pic.twitter.com/CXMhzSEMWu</a></p>&mdash; Kuro (@PRiMENON) <a href=\"https://twitter.com/PRiMENON/status/1472553760916635648?ref_src=twsrc%5Etfw\">December 19, 2021</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<p>Twitter をちゃんと活用している場合は良いのですが、情報発信するだけでメンションを見ていない場合もあります。2日後、Twitter に返信があり続きは DM でやりとりしました。内容は、今回の改ざんで私が被害に遭われていないかの確認でした。</p>\n<p>その後、UTYテレビ山梨のニュースや読売新聞の記事やYahoo!ニュースにもなったようです。2023年現在、確認できるのは読売新聞の記事だけです。</p>\n<ul>\n<li><a href=\"https://www.yomiuri.co.jp/national/20211225-OYT1T50089/\">県図書館の運営サイト、いつのまにか詐欺ページ多数…ツイッター書き込みで被害に気づく</a>　読売新聞オンライン 2022-12-27</li>\n</ul>\n<p>UTYテレビ山梨 2021-12-24\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.26582278481011%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADzElEQVQ4y22T208bRxSH/e/1vZXaPrTqS6NIQKKUVJQEEm6FAFUx4aKGUpI0RVHTQFIQFDDCYMLVDsaObfBljSH23mbHe5+d3ZmdarmkrdRPR6MzD5/mHP00IXaBgxhUmG0S6juWraouIcx1fUrZf/CpTz3mE8YYhFqIMUYpnZtf+n1u7XX0cCYSn40kZiPxmZXEXPQgaCKJl8v7L5b2ni9sP1/YnvwjupMsMMaAooUopb7vp9OZ9c3d+OFRMpNPviukclwqWzrI5JPZ4n7qKJnlihUpXxaOy3yudCbIKmNMgVrItm2MsSSJ+fwxAEAG6uWAPiUYUxu5lsUoESXr5NSs1lCtJksijzHWdDOEEHIcRxDFUrGUzhxvJfKlIsdxXPmkUshkD1djiYVVoVwRFaNQBKKk8yIAAGDsaIYVvEwpXVycb2u929fT3/9goK93oL9vYPiHofDg4IPOru72tkR8XzPQyakiAyd1mDxM7RFCNf1cJsSPvZkZGxkMDw09+unZ2MjULxPTE2OPJ0YmZ6f/fDX9gisUJGDl8oCXUPwgFd1Yo5QGY9u2RYi/sfVyoK+5tfl6W/u33Z33unvaOztaejtaR8Pfjz/symbfwrpTKgOoOunM0dvkHiHEMM9lz/N3dl/dv/91S2vTnbaGzs6Wro7b9+419Hbf6um4frvl40RiHda9IgdFyS5xJ4VCwfPci50tSvzF5d9u3Lz21ZcNn33yxa3GO82Nd79p/K7h2o2bTU2ffv5RZHUBqm6pDGTFLnFnHMe5rqublzuTra3Y+PjI2NhoODw0NTn15PGTnx9NDIeHx8dHH478mE4lAXTKFSjJKJ0t5nJZz/N0w7qICmGMHQd7nvdPyJScN8HVdV2eFyCEClDOARhj3bjK2dB1AIASRKiIonhaqQSdoghC4CBkn1XrxwWFF+144mBlZcmnvqYbl7JpmLVaDQCgXgEhVFXVQci2bYQQUHRB0gyL7O3srK/+RamvXbyMMQYAnFYq1SpffV9TFABkGUKo6wbG2A3AgqTVeFWpu1ux6ObafCCbV7IMZJ7nDRMJogwAqEMoybKqqlpQGsaOKGnvq6oko3giFYtGfUpV88POhgEhtCwTIdtxHMu2TdM0dMOyLOQ4ruueVbWT07qqe+vR2MLca+azSxkh5BEv+JuM/bs+4HkeUKAM6pqO3mVyG5tvCCHB2A5CDkKUUuYHsP+DECIImiColuUvLS3/+uwpY0wzjVDVMIGNRNMqQ1g1TBm7EsbS5XlRrohQXoRHPChDK7K7Pbe+CrB3qul/A77PCbf9BcCkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"県立図書館のウェブサイトからフィッシング詐欺サイトに移動　何者かが改ざんか　山梨\"\n        title=\"県立図書館のウェブサイトからフィッシング詐欺サイトに移動　何者かが改ざんか　山梨\"\n        src=\"/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/f058b/yahoo-co-jp_2021-12-24T1931.png\"\n        srcset=\"/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/c26ae/yahoo-co-jp_2021-12-24T1931.png 158w,\n/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/6bdcf/yahoo-co-jp_2021-12-24T1931.png 315w,\n/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/f058b/yahoo-co-jp_2021-12-24T1931.png 630w,\n/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/40601/yahoo-co-jp_2021-12-24T1931.png 945w,\n/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/78612/yahoo-co-jp_2021-12-24T1931.png 1260w,\n/static/c6b85b73f3fcd3a195cc82c7a2ef4fe2/21b4d/yahoo-co-jp_2021-12-24T1931.png 1280w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2>今はどうなったか</h2>\n<p>あれから1年以上経過しましたが、依然としてインターネット上には、改ざんされていることのに気づかず運用しているサイトが存在します。</p>\n<p>山梨県立図書館の事例は、自治体でしたので早急に対応してもらえました。一方、企業や教育機関のサイトは連絡方法がメールや電話しかなく通報が困難です。どうにもできずに、<a href=\"https://www.jpcert.or.jp/\">JPCERT</a> に連絡したこともあります。</p>\n<p>兎にも角にも、私はインターネットで欲しい情報が安全に探せるようになって欲しい、ただそれに尽きます。</p>","frontmatter":{"title":"山梨県立図書館が管理しているウェブサイトが改ざんされているのを見つけた話（2021年12月）","date":"2023-01-09T11:25:00+09:00","description":"当時、ブログを持っていなかったのでアウトプットしませんでしたが、ブログを作ったのでこのことを記しておこうと思います。","tags":["セキュリティ"]}},"previous":{"fields":{"slug":"/20230103-01/"},"frontmatter":{"title":"年末年始が終わる","date":"2023-01-03T21:51:00+09:00"}},"next":null},"pageContext":{"id":"1ba7afa4-11c5-5534-91bb-2ad7e29da786","previousPostId":"ee6b7c9b-08cd-5ba3-acf8-c73c370f9c97","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}